---
title: "Shiny Basics"
author: "Venture"
date: "2/15/2022"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
# install the package
#install.packages("shiny")

# importing the packages
library(shiny)
library(shinyWidgets)

# Creating the UI
UI<-shinyUI(
  fluidPage(
    titlePanel(title = "This is my first shiny application"),
    sidebarLayout(
      sidebarPanel(h3("Enter personal information"),
        textInput("name","Enter your name",""),
        textInput("age","Enter your age",""),
        radioButtons("gender","Choose your gender","Male",choices = c("Male","Female")),
        sliderInput("height","Select your height",min = 0,max = 3,value = 2,step = 0.5),
        pickerInput("country","choose your country of residence",
                    selected ="Kenya",options = list(`actions-box`=T),
                    choices = c("Kenya","Uganda","Tanzania"),multiple = T),
        
        submitButton("Submit")
        
      ),
      mainPanel(h3("Display Personal Information"),
        textOutput("myname"),
        textOutput("myage"),
        textOutput("mygender"),
        textOutput("myheight"),
        textOutput("mycountry")
        
        
      )
    )
    
  )
)

server<-function(input,output,session){
  output$myname=renderText({paste("My name is:",input$name)})
  output$myage=renderText({paste("Your age is:",input$age,"Years")})
  output$mygender<-renderText({paste("Your gender is:",input$gender)})
  output$myheight<-renderText({paste("My height is:",input$height,"M")})
  output$mycountry<-renderText({paste("I am from this country:",input$country)})
  
}

shinyApp(UI,server)
 
```



```{r}
# Importing the packages
library(shiny)
library(shinyWidgets)
library(dplyr)

# creating the UI
ui<-shinyUI(fluidPage(
  titlePanel(title="using renderplot()"),
  sidebarLayout(
    sidebarPanel(),
    mainPanel()
  )
))


server<-function(input,output,session){
  
}

shinyApp(ui,server)

```
```{r}
library(ggplot2)
library(shiny)
library(dplyr)

# use selectinput() for the columns
UI<-shinyUI(fluidPage(
  titlePanel(title="Use selectinput for the columns"),
  sidebarLayout(
    sidebarPanel(
      selectInput("var","select the variable from the dataset",
                  choices = c("Sepal.Length"=1,"Petal.Width"=2,
                              "Sepal.Width"=3,"Petal.Length"=4),
                  selected = "Sepal.Length"),
      sliderInput("brek","Select the BINS of histogram",
                  min=20,max=60,value = 30),
      radioButtons("color","Select the color of your histogram",
                   choices=c("green","yellow","blue"),
                   selected = "green")
      
    ),
    mainPanel(
      tabsetPanel(type="tab",
                  tabPanel("Summary",verbatimTextOutput("sum")),
                  tabPanel("Structure",verbatimTextOutput("str")),
                  tabPanel("Data",tableOutput("data")),
                  tabPanel("Plot",plotOutput("myplot"))
                  
                  )
    )
  )
    
)
)

server<-function(input,output,session){
  colm<-reactive({as.numeric(input$var)})
  
  output$data<-renderTable({
    iris[colm()]
  })
  
  output$str<-renderPrint({
    str(iris)
  })
  
  output$sum<-renderPrint({
    summary(iris)
  })
  
  output$myplot <- renderPlot({
   
    hist(
      iris[, colm()],
      freq = FALSE,
      col = input$color,
      xlab = names(iris[colm()]),
      main = "Colored histogram",
      breaks = seq(0, max(iris[, colm()]), l = input$brek + 1)
    )
    
    # add a normal distribution line in histogram
    curve(dnorm(x,
                mean = mean(iris[, colm()]),
                sd = sd(iris[, colm()])),
          add = TRUE,
          col = "red",
          lwd=3) #line
  })
  
}


shinyApp(UI,server)
```

# How to use the renderUI() function in server 

```{r}
library(shiny)
UI<-shinyUI(fluidPage(
  titlePanel(title = "How to use the renderUI ()"),
  sidebarLayout(
    sidebarPanel(
      selectInput("data","Choose the dataset",
                  choices = c("iris","mtcars","trees"),
                  selected = "iris"),
      uiOutput("vx"),
      uiOutput("vy")
    ),
    mainPanel(plotOutput("plot"))
  )
))

server<-function(input,output,session){
  # Creating the var reactive 
  var<-reactive({
    switch(
    input$data,
    "iris"=names(iris),
    "mtcars"=names(mtcars),
    "trees"=names(trees)
    )
  })
  
  
  output$vx<-renderUI({
    selectInput("variablex","Select the variable (X)",choices=var())
  })
  
  output$vy<-renderUI({
    selectInput("variabley","Select the variable (Y)",choices=var())
  })
  
  output$plot<-renderPlot({
    attach(get(input$data))
    plot(x=get(input$variablex),y=get(input$variabley),
         xlab=input$variablex,
         ylab=input$variabley)
  })
}

shinyApp(UI,server)

```

# Making use of isolate() and actionButton()

```{r}
library(shiny)

UI<-shinyUI(fluidPage(
  titlePanel(title="Isolate and actionButton"),
  sidebarLayout(
    sidebarPanel(
      selectInput("data","select your dataset",
                  choices=c("iris","mtcars","trees"),
                  selected = "iris"),
      numericInput("obs","select the number of observations",
                  min = 5,
                  max=10,
                  value = 6,
                  step = 1),
      actionButton("act","Update Observations!"),
      
      # Include image
      h6("Powered by"),
      img(src="R.png",height=50,width=50)
      
    ),
    mainPanel(
      # Print the structure of the data selected
      verbatimTextOutput("str"),
      
      # Print the head of the data selected
      tableOutput("head")
    )
  )
))

server<-function(input,output,session){
  # print the structure of the dataset
  output$str<-renderPrint({
    str(get(input$data))
  })
  
  output$head<-renderTable({
    # isolate is always used with the actionButton
    # It controls reactivity!
    # What is to be controlled has to be within the isolate function
    
    input$act
    isolate(head(get(input$data),n=input$obs))
  })
}

shinyApp(UI,server)
```

